---
import Logo from "../assets/logo.svg";
import ButtonClose from "./ButtonClose.astro";
import ButtonMenu from "./ButtonMenu.astro";
import NavGroup from "./NavGroup.astro";
---

<header>
  <div id="menu" class="absolute top-0 z-10 hidden h-[110px] w-full bg-white">
    <NavGroup />
  </div>
  <ButtonClose />
  <ButtonMenu />
  <div
    class="absolute top-[48px] left-1/2 z-10 w-fit -translate-x-1/2 lg:hidden"
  >
    <Logo id="logo" />
  </div>
</header>

<script>
  const menu = document.getElementById("menu") as HTMLUListElement;
  const iconBurger = document.getElementById(
    "icon-burger",
  ) as HTMLButtonElement;
  const iconClose = document.getElementById("icon-close") as HTMLButtonElement;
  const logoEl = document.getElementById("logo") as HTMLElement;

  function openMenu() {
    iconBurger.classList.add("hidden");
    iconClose.classList.remove("hidden");
    menu.classList.remove("hidden");
    logoEl.classList.add("hidden");
  }
  function closeMenu() {
    iconBurger.classList.remove("hidden");
    iconClose.classList.add("hidden");
    menu.classList.add("hidden");
    logoEl.classList.remove("hidden");
  }

  iconBurger.addEventListener("click", openMenu);
  iconClose.addEventListener("click", closeMenu);

  document.addEventListener("click", (e) => {
    const target = e.target as Node;
    const isClickInside = iconBurger.contains(target) || menu.contains(target);
    if (!isClickInside && menu.classList.contains("open")) {
      menu.classList.remove("open");
      menu.classList.add("hidden");
      iconBurger.setAttribute("aria-expanded", "false");
    }
  });
</script>
